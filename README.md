# 🧩 프로젝트 구조 가이드

이 프로젝트는 **Next.js App Router 기반**의 구조로, 기능 단위의 확장성과 유지보수를 고려하여 아래와 같은 기준으로 설계되었습니다.

---

## 🧭 설계 목적 및 방향

이 프로젝트는 **기능 중심 설계**와 **컴포넌트 재사용성**, **효율적인 테스트**를 중심으로 구성되어 있으며, 다음과 같은 기준으로 설계되었습니다:

### ✅ 1. 라우팅과 뷰 분리 (`app/`)

- URL에 따른 페이지 구성을 담당합니다.
- 각 페이지에서만 사용하는 UI 조각은 `app/페이지명/_components/`에 분리하여 구성합니다.

### ✅ 2. 기능 중심 구조 (`features/`)

- 인증, 게시글, 사용자 등 **도메인별로 기능을 모듈화**합니다.
- 컴포넌트, 훅, API, 타입, 테스트를 **도메인 단위로 집중 관리**하여 응집도와 유지보수성을 높입니다.

### ✅ 3. 공통 컴포넌트 재사용 (`components/`)

- 전역에서 사용하는 버튼, 인풋, 모달 등 **UI 요소들을 한 곳에 모아 관리**합니다.
- 디자인 일관성과 재사용성 확보가 용이해집니다.

### ✅ 4. 테스트 내재화 (`__tests__/`)

- 각 기능 단위에서 바로 테스트할 수 있도록 폴더 안에 `__tests__` 디렉토리를 구성합니다.
- **기능 단위 테스트를 인라인화**하여, 리팩토링 및 QA 시 빠른 피드백 루프를 확보합니다.

### ✅ 5. 공통 상태 관리 도입 (`store/`, `features/도메인/store/`)

- 앱 전역에서 사용되는 상태(UI 상태, 모달 등)는 `store/`에 구성하고,
- 인증 등 도메인 전용 상태는 `features/도메인/store/`에 위치시켜 관리합니다.
- 이를 통해 상태 관리의 책임과 범위를 명확히 구분할 수 있습니다.

### ✅ 6. API 모듈 공통화 (`shared/api/`)

- axios 인스턴스 설정, 공통 헤더, 인터셉터 등은 `shared/api/axiosInstance.ts`에 구성합니다.
- 각 도메인의 API는 `features/도메인/services/`에 작성하고, 공통 유틸과 경로 상수는 `shared/api/endpoints.ts` 등에서 관리하여 API 관리 효율을 높입니다.

---

## 📐 프로젝트 디렉토리 구조

```plaintext
src/
├── app/                                        # 라우팅 페이지 디렉토리
│   ├── page.tsx                                # 루트 페이지
│   ├── layout.tsx                              # 전체 레이아웃 설정
│   └── login/                                  # "/login" 페이지
│       ├── page.tsx                            # 로그인 라우트 컴포넌트
│       └── _components/                        # 로그인 페이지 전용 UI 조각 모음
│           └── LoginBanner.tsx                 # 설명 배너 등 페이지에만 사용되는 UI
├── components/                                 # 전역 공통 UI 컴포넌트 모음
│   ├── ui/                                     # 버튼, 인풋 등 기본 요소
│   │   ├── Button.tsx
│   │   └── Input.tsx
│   ├── layout/                                 # 페이지 레이아웃 구성 요소
│   │   ├── Header.tsx
│   │   └── Footer.tsx
│   └── feedback/                               # 사용자 반응 컴포넌트
│       ├── Spinner.tsx
│       └── Alert.tsx
├── features/                                   # 기능(도메인) 단위 로직/뷰/훅 모음
│   └── auth/                                   # 도메인 (로그인, 회원가입 등)
│       ├── components/                         # 도메인 전용 컴포넌트
│       │   ├── LoginForm.tsx
│       │   └── SignupForm.tsx
│       ├── hooks/                              # 인증 도메인 전용 커스텀 훅
│       │   └── useLogin.ts
│       ├── services/                           # axios or fetch 기반 API 함수 정의
│       │   └── authApi.ts
│       ├── types/                              # 도메인 타입 정의
│       │   └── auth.d.ts
│       ├── store/                              # (확장) 인증 상태 관리 모듈 (zustand/recoil 등)
│       │   └── authStore.ts
│       └── __tests__/                          # auth 도메인 관련 테스트 파일
│           ├── LoginForm.test.tsx
│           └── useLogin.test.ts
├── shared/                                     # 공통 유틸, 상수, API 모듈 등 모음
│   └── api/                                    # API 추상화 및 공통 유틸
│       ├── axiosInstance.ts                    # axios 인터셉터, 공통 설정
│       └── endpoints.ts                        # API URL 및 경로 상수 관리
├── store/                                      # (확장) 글로벌 상태 관리 전역 모듈
│   └── uiStore.ts                              # 예: 글로벌 모달 상태, 로딩 상태 등

```

---

## 상태관리

Controlled Component 방식을 사용, 커스텀 useState는 상위 컴포넌트에서 호출해서 하위 컴포넌트에 props로 넘겨주는 방식사용.

### ✅ 1. 예측 가능성

- 데이터 흐름이 한 방향이라 상태 변화가 명확함.

### ✅ 2. 재사용성

- 여러 부모 컴포넌트 에서든 사용할 수 있음.

### ✅ 3. 테스트 용이

- props만 넘기면 바로 테스트 가능.

### ✅ 4. 상태 제어 (의존성)

- 비지니스의 전체 상태를 중앙집중식으로 관리 가능.
- 상태흐름이 분산되어 관리가 힘듬.

### ✅ 5. 상태 공유

- 여러 컴포넌트에서 호출하면 서로다은 상태를 가질 수 있음음.

---

## 타입

### ✅ 1. 하나의 컴포넌트에서만 사용

- 컴포넌트 파일 내부에 작성성

### ✅ 2. 여러 컴포넌트에서 공유

- types/로 분리

### ✅ 3. 도메인 간 공유 or API 요청 타입

- types/ 에 DTO처럼 관리
- 도메인 간 의존 관리

---

## 🧪 테스트 설계 기준 및 프로젝트 테스트 전략

이 프로젝트는 **기능 중심 도메인 구조(features/)** 를 기반으로, 각 기능의 UI, 로직, API, 상태 등을 **컴포넌트 단위와 사용자 흐름 중심**으로 테스트합니다.

테스트는 크게 다음의 목적과 원칙을 중심으로 설계되었습니다.

---

### ✅ 테스트 목적

- **사용자 관점의 동작 검증**: 실제 브라우저에서 사용자가 조작하는 흐름과 최대한 유사하게 테스트
- **유지보수성과 확장성 확보**: 기능별로 책임이 나뉜 구조에서, 해당 책임에 대한 테스트를 인라인으로 유지
- **신뢰 가능한 자동화 기반 확보**: CI 환경에서도 안정적인 테스트 수행과 실패 피드백 제공

---

### ✅ 테스트 구성 기준

| 기준                   | 설명                                                                            |
| ---------------------- | ------------------------------------------------------------------------------- |
| **도메인별 분리**      | `features/도메인/__tests__` 구조로 기능별 테스트 코드 위치를 고정               |
| **컴포넌트 테스트**    | 단일 UI 요소(예: 인풋, 버튼 등)의 렌더링/입력/상태를 검증                       |
| **유효성 테스트**      | 사용자 입력 흐름에서 발생할 수 있는 예외(누락, 오류 등)를 검증                  |
| **제출 및 API 테스트** | 폼 제출, 비즈니스 로직 수행, 요청-응답 처리 검증 포함                           |
| **통합 흐름 테스트**   | 단일 시나리오에서 사용자 인터랙션부터 후처리까지 확인 (`로그인 후 리디렉션` 등) |

---

### ✅ 테스트 도구

- **Testing Library** – 사용자 관점에서 DOM을 테스트
- **Jest** – 단위 테스트 실행 및 Mock 함수 활용
- **userEvent** – 실제 사용자 입력 시뮬레이션 (ex. `type`, `click`)

---

### ✅ 테스트 디렉토리 구조 예시

```plaintext
src/
├── features/
│   └── auth/
│       ├── components/
│       │   └── LoginForm.tsx
│       ├── hooks/
│       │   └── useLogin.ts
│       ├── __tests__/
│       │   └── login.test.tsx ← 로그인 시나리오 테스트
│
├── components/
│   └── ui/
│       ├── Input.tsx
│       └── Button.tsx
│       └── __tests__/
│           └── Input.test.tsx ← UI 컴포넌트 단위 테스트
```

---

### ✅ 모킹 전략

| 대상                             | 방식                                                | 목적                                |
| -------------------------------- | --------------------------------------------------- | ----------------------------------- |
| `useRouter()`                    | `jest.mock("next/navigation")` + `mockPush()`       | 페이지 이동 여부 검증               |
| `useLogin()` (커스텀 훅)         | `jest.fn()` 으로 모킹하여 호출 여부와 파라미터 검증 | 인증 로직 검증                      |
| `fetch` 또는 API 요청 함수       | `jest.mock` 또는 `MSW` 사용                         | 네트워크 호출 제거, 응답 시뮬레이션 |
| `window.alert`, `window.confirm` | `jest.spyOn(window, "alert")`                       | 사용자 피드백 확인                  |

> ✅ 공통 Mock 객체들은 `/__mocks__` 폴더에 위치시켜 **테스트 간 공유 및 재사용** 가능

---

### ✅ 테스트 스타일

- 모든 테스트는 **한글 BDD 문장** 기반으로 작성 (자연어 설명 강조)
- `describe`는 기능 단위, `it`은 동작 결과 또는 예외 처리를 기준으로 분리
- `describe.each()`를 활용해 입력 조합에 따른 반복 테스트 수행
- `beforeEach` 내부에서 `mockFn.mockClear()`를 호출해 테스트 간 상태를 분리

---

### ✅ 향후 확장 고려

- **통합 테스트 도입**: 로그인 → 페이지 이동 → 특정 요소 확인까지 흐름 전체 검증
- **MSW 적용**: 실제 네트워크 요청이 없어도 **응답 시나리오 기반 테스트 가능**
- **CI 환경 연결**: GitHub Actions 또는 Vercel Preview에서 자동 테스트 실행 가능
- **커버리지 리포트 도입**: `--coverage` 옵션으로 테스트 커버리지 시각화 가능

---

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```
